---
title: 设置
description: 本文介绍如何快速作为开发者完成设置并开始在 Wink 上测试我们的 API。
sidebar:
  order: 1
---

import { Steps } from '@astrojs/starlight/components';
import CloudinaryImage from '/src/components/cloudinary-image.astro';

本文介绍如何快速作为开发者完成设置并开始在 Wink 上测试我们的 API。

:::note
测试应始终在我们的 [预发布环境](/getting-started/environments) 进行。那里数据较少，但您可以自由测试，无需影响生产环境。

一旦准备上线，我们将认证您的账户和应用，您即可在生产环境中发布。
:::

请按照以下步骤操作：

<Steps>
1. 在 Wink 上 [注册](/user/register) 您的用户账户
2. 创建一个 [旅行代理账户](/travel-agent/what-is-agent) 或 [旅行代理账户](/travel-agent/what-is-agent) 。
3. [创建应用](/developer/applications) ，并将其与步骤 2 中创建的账户关联。
4. 创建 `Application` 后，请妥善保存 client-id 和 client secret。
</Steps>

## CDN

在 Wink，我们使用 Cloudinary 管理所有图片和视频资源。访问我们的旅游库存时，您将完全享受 Cloudinary 的所有高级功能。

我们的 `cloud_name` 是 `traveliko`。

### Cloudinary

- [入门指南](https://cloudinary.com/documentation/dev_kickstart)
- [SDKs](https://cloudinary.com/documentation/cloudinary_sdks)
- [Cloudinary GitHub](https://github.com/cloudinary)
- [视频教程](https://cloudinary.com/documentation/cloudinary_sdks_tutorials)

### 示例

对于我们支持的每种旅游库存类型，都会有一个名为 `multimedias` 的嵌套 JSON 数组。多媒体条目的 JSON 如下所示：

```json {3}
{
  "multimediaIdentifier": "multimedia-1",
  "identifier": "partners/radisson_blu_logo",
  "type": "IMAGE",
  "width": "1024",
  "height": "768",
  "category": "1",
  "descriptions": [
    {
      "name": "Lobby",
      "description": "Picture of the lobby",
      "language": "en"
    }
  ],
  "lifestyleType": "LIFESTYLE_BUSINESS",
  "attribution": [
    {
      "url": "https://www.hilton.com",
      "name": "Hilton"
    }
  ]
}
```

上面高亮的行显示了 Cloudinary 的唯一 ID `partners/radisson_blu_logo`。这就是您获取任意格式、质量和尺寸图片所需的全部信息。

## 测试

请前往我们的 [API](/developer/apis) 部分，选择您想使用的 API。

### API 文档

我们的文档网站支持直接在站内运行 API 命令。

在此示例中，您将使用 `Search Lookups (OAuth2)` API 调用。

:::tip[专业提示]
为了方便使用，我们建议集成者使用标记为 `OAuth2` 的端点。这些端点会自动识别调用者账户，无需在 URL 中指定 `companyIdentifier`。
:::

<Steps>
1. 使用 [Lookup API](https://developer.wink.travel/lookup) 检索目的地或酒店。
2. 在左侧导航栏点击 `Authentication`。
3. 输入您的 client-id 和 client secret，点击 `Get TOKEN` 按钮。
4. 如果凭证有效，您将看到 API 密钥已应用。
5. 现在可以测试 lookup 端点。
</Steps>

<figure>
<CloudinaryImage
      width="700"
      height="265"
      resize="scale"
      quality="best"
      alt="Lookup API endpoint"
      src="academy/lookup-api-call"
      errorImage="noimage_opaque_nyrtl0.png"
    />
    <figcaption>*搜索查找（OAuth2）示例*</figcaption>
</figure>

### Postman
您也可以使用 Postman 完成相同操作。

<Steps>
1. 下载 [Postman](https://www.postman.com/downloads) 。
2. 在 [Lookup API](https://developer.wink.travel/lookup) 页面顶部点击 `Download OpenAPI spec`。
3. 将其导入 Postman。
4. 如果导入为名为 `Wink API` 的新集合，点击集合名称旁的横向省略号（三点），选择 `Edit`。
5. 在 `Authorization` 标签页，将 `Auth type` 设置为 OAuth2。
6. 将 `Add auth data to` 设置为 `Request headers`。
7. 将 `Header prefix` 设置为 `Bearer`。
8. 将 `Token Name` 设置为您想在 Postman 中保存的令牌名称，例如 Wink Staging。
9. 将 `Grant type` 设置为 `Client Credentials`。
10. 将 `Access token URL` 设置为 https://staging-iam.wink.travel/oauth2/token。
11. 将 `Client ID` 设置为您的应用生成的 Client ID。
12. 将 `Client Secret` 设置为您的应用生成的 Client Secret。
13. 将 `Scope` 设置为 `inventory.read inventory.write inventory.remove`。这些是 Wink 所需的全部权限范围。
14. 将 `Client Authentication` 设置为 `Send as Basic Auth header`。
15. 点击 `Get New Access Token` 按钮获取并保存令牌。
16. 对 Wink API 集合下的所有 API 调用，确保认证标签页显示 `Inherit auth from parent`，以便每次调用都包含令牌。
</Steps>

:::tip[专业提示]
建议将服务器域名、Client ID 和 Client Secret 设置为环境变量。这样可以轻松切换预发布和生产环境，并复用所有已创建的操作。
:::
