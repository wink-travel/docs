---
title: Webhooks
description: Wink と TripPay のイベントを購読する。
sidebar:
  order: 4
---

import { Steps } from '@astrojs/starlight/components';
import CloudinaryImage from '/src/components/cloudinary-image.astro';

Webhooks は、Wink と TripPay からあなたのアカウントに関するリアルタイムイベントを受信し、それに対応する方法です。

## 例

<Steps>
1. Wink で予約が発生します。
1. Wink のイベント `booking.created` が発行されます。
2. あなたのシステムはこのイベントを積極的にリッスンしています。
3. あなたのシステムは独自の分析を追跡し、このイベントを使って時系列データベースを更新します。
</Steps>

<figure>
<CloudinaryImage
      width="350"
      height="215"
      resize="scale"
      quality="best"
      alt="Sample webhook"
      src="academy/webhook"
      errorImage="noimage_opaque_nyrtl0.png"
    />
    <figcaption>*サンプル webhook エントリー*</figcaption>
</figure>

:::note
Wink の webhook は TripPay の webhook とは異なります。

- Wink のイベントをリッスンしたい場合は、[Extranet](https://extranet.wink.travel) または [Studio](https://studio.wink.travel) から webhook を作成できます。
- TripPay のイベントをリッスンしたい場合は、[Payment](https://pay.wink.travel) から webhook を作成できます。
:::

*この例では、[Studio](https://studio.wink.travel) を通じて認証します。*

<Steps>
1. 認証が完了したら、右上のプロフィールアイコンをクリックするとメニューが表示されます。
2. `Webhooks` リンクをクリックします。
3. webhook ページにリダイレクトされます。
</Steps>

## webhook の作成

:::caution
webhook を作成する前に、Wink のアフィリエイトアカウントまたは TripPay のアカウントを作成しておく必要があります。webhook は特定のアカウントに紐づけられるためです。
:::

webhook を作成する手順は以下の通りです：

<Steps>
1. webhook ページから、`Create new webhook` ボタンをクリックします。
2. ***名前*** webhook に名前を付けます。*例: Wink Stalker*
3. ***有効*** そのままにして有効にします。
4. **エンティティ名** 既存のアカウントのいずれかに webhook をリンクします。*例: Cool Account*
5. **イベント** 興味のあるイベントをリッスンします。*例: `booking.created`*
6. **Webhook URL** イベントを受信する URL を入力します。*例: `https://my.system.com/webhook/wink`*
7. `Save` ボタンをクリックして続行します。
</Steps>

webhook の一覧にリダイレクトされ、新しい webhook が利用可能になります。

## webhook の更新

以下の場合はアプリを更新する必要があります：

- webhook を無効にしたい場合。
- もっと多く/少ないイベントをリッスンしたい場合。
- リッスンする webhook URL を変更したい場合。

既存の webhook を更新するには、以下を行います：

<Steps>
1. 更新したい webhook の `Actions` リンクをクリックします。
2. `Update` ボタンをクリックします。
3. webhook の変更を行います。
4. `Save` ボタンをクリックして続行します。
</Steps>

webhook の一覧にリダイレクトされます。

## webhook の削除

webhook が不要になった場合は、削除できます。

webhook を削除するには、以下を行います：

<Steps>
1. 削除したい webhook の `Actions` リンクをクリックします。
2. `Remove` ボタンをクリックします。
3. 削除確認のため `OK` ボタンをクリックします。
</Steps>

webhook の一覧にリダイレクトされます。
