---
title: セットアップ
description: この記事では、開発者として迅速にセットアップし、WinkのAPIをテストし始める方法を説明します。
sidebar:
  order: 1
---

import { Steps } from '@astrojs/starlight/components';
import CloudinaryImage from '/src/components/cloudinary-image.astro';

この記事では、開発者として迅速にセットアップし、WinkのAPIをテストし始める方法を説明します。

:::note
テストは常に[ステージング環境](/ja/getting-started/environments)で行うべきです。そこにはデータが少ないですが、本番環境に影響を与えることなく自由にテストできます。

本番稼働の準備が整ったら、アカウントとアプリケーションの認証を行い、本番環境での公開が可能になります。
:::

以下の手順に従ってください：

<Steps>
1. Winkでユーザーアカウントを[登録](/ja/user/register)します
2. [旅行代理店アカウント](/ja/travel-agent/what-is-agent)または[アフィリエイトアカウント](/ja/studio/what-is-studio)を作成します。
3. ステップ2で作成したアカウントに紐づける[アプリケーションを作成](/ja/developer/applications)します。
4. `Application`を作成したら、client-idとclient secretを安全な場所に保存してください。
</Steps>

## CDN

Winkでは、すべての画像および動画資産にCloudinaryを使用しています。旅行在庫にアクセスすると、Cloudinaryの高度な機能をすべて利用できます。

当社の`cloud_name`は `traveliko`です。

### Cloudinary

- [はじめに](https://cloudinary.com/documentation/dev_kickstart)
- [SDK](https://cloudinary.com/documentation/cloudinary_sdks)
- [GitHubのCloudinary](https://github.com/cloudinary)
-	[ビデオチュートリアル](https://cloudinary.com/documentation/cloudinary_sdks_tutorials)

### 例

サポートしているすべての旅行在庫タイプには、`multimedias`というネストされたJSON配列があります。マルチメディアエントリのJSONは以下のようになります：

```json {3}
{
  "multimediaIdentifier": "multimedia-1",
  "identifier": "partners/radisson_blu_logo",
  "type": "IMAGE",
  "width": "1024",
  "height": "768",
  "category": "1",
  "descriptions": [
    {
      "name": "Lobby",
      "description": "Picture of the lobby",
      "language": "en"
    }
  ],
  "lifestyleType": "LIFESTYLE_BUSINESS",
  "attribution": [
    {
      "url": "https://www.hilton.com",
      "name": "Hilton"
    }
  ]
}
```

上記のハイライトされた行はCloudinaryのユニークID `partners/radisson_blu_logo`を示しています。これだけで、任意のフォーマット、品質、サイズで画像を取得できます。

## テスト

[API](/ja/developer/apis)セクションにアクセスし、使用したいAPIを選択してください。

### APIドキュメント

当社のドキュメントサイトは、サイト内からAPIコマンドを実行できるように設定されています。

この例では、`Search Lookups (OAuth2)` APIコールを使用します。

:::tip[プロのヒント]
使いやすさのために、統合者には`OAuth2`として指定されたエンドポイントの使用を推奨します。これらのエンドポイントはAPIコール元を認識し、どのアカウントかを既に把握しているため、URLに`companyIdentifier`を指定する必要がありません。
:::

<Steps>
1. [Lookup API](https://developer.wink.travel/lookup)を使って目的地やホテルを取得します。
2. 左のナビゲーションバーで`Authentication`をクリックします。
3. client-idとclient secretを入力し、`Get TOKEN`ボタンをクリックします。
4. 資格情報が有効であれば、APIキーが適用されたことが表示されます。
5. これでlookupエンドポイントをテストできます。
</Steps>

<figure>
<CloudinaryImage
      width="700"
      height="265"
      resize="scale"
      quality="best"
      alt="Lookup API endpoint"
      src="academy/lookup-api-call"
      errorImage="noimage_opaque_nyrtl0.png"
    />
    <figcaption>*Search Lookups (OAuth2)のサンプル*</figcaption>
</figure>

### Postman
Postmanでも同様のことができます。

<Steps>
1. [Postman](https://www.postman.com/downloads)をダウンロードします。
2. [Lookup API](https://developer.wink.travel/lookup)ページの上部から`Download OpenAPI spec`をクリックします。
3. それをPostmanにインポートします。
4. 新しいコレクション`Wink API`としてインポートした場合、コレクション名の横の横三点リーダー（3点）をクリックし、`Edit`を選択します。
5. `Authorization`タブで`Auth type`をOAuth2に設定します。
6. `Add auth data to`を`Request headers`に設定します。
7. `Header prefix`を`Bearer`に設定します。
8. `Token Name`にPostmanで保存するトークン名を任意に設定します。例：Wink Staging。
9. `Grant type`を`Client Credentials`に設定します。
10. `Access token URL`を https://staging-iam.wink.travel/oauth2/token に設定します。
11. `Client ID`にアプリが生成したClient IDを設定します。
12. `Client Secret`にアプリが生成したClient Secretを設定します。
13. `Scope`に `inventory.read inventory.write inventory.remove` を設定します。これがWinkで必要なすべてのスコープです。
14. `Client Authentication`を`Send as Basic Auth header`に設定します。
15. `Get New Access Token`ボタンをクリックしてトークンを取得し、保存します。
16. Wink APIコレクション内のすべてのAPIコールで、認証タブが`Inherit auth from parent`になっていることを確認し、すべてのコールにトークンが含まれるようにします。
</Steps>

:::tip[プロのヒント]
サーバードメイン、クライアントID、クライアントシークレットを環境変数にすることを推奨します。これにより、ステージングと本番環境を簡単に切り替え、作成したすべての操作を再利用できます。
:::
